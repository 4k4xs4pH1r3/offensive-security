# Enable Digitally RemoteSigned
Set-ExecutionPolicy Unrestricted -Scope CurrentUser -Force
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# Create the registry key for 64-bit systems
New-Item -Path "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config" -Force | Out-Null
Set-ItemProperty -Path "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord

# Create the registry key for 32-bit applications on 64-bit systems
New-Item -Path "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config" -Force | Out-Null
Set-ItemProperty -Path "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config" -Name "EnableCertPaddingCheck" -Value 1 -Type DWord

# Create an array of custom objects to store the key details
$keyDetails = @(
    [PSCustomObject]@{
        Path  = "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config"
        Key   = "EnableCertPaddingCheck"
        Value = (Get-ItemProperty -Path "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config").EnableCertPaddingCheck
    },
    [PSCustomObject]@{
        Path  = "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config"
        Key   = "EnableCertPaddingCheck"
        Value = (Get-ItemProperty -Path "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config").EnableCertPaddingCheck
    }
)

# Display the key details in a table format
$keyDetails | Format-Table -AutoSize

Write-Host "Registry keys added successfully."
